<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<?xml-stylesheet type="text/xsl" href="./modx.prosilver.en.xsl"?>
<!-- UMIL by the phpBB.com MOD Team. Copyright 2008 the phpBB Group.
Please check: http://www.phpbb.com/mods/umil for the latest version of the UMI Library or for any support needed for UMIL.
 $Id$ -->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.5.xsd">
<header>
	<license>http://opensource.org/licenses/gpl-license.php GNU General Public License v2</license>
	<title lang="cn">编程论坛模块</title>
	<description lang="cn">包含了将一个普通的phpBB论坛改造为编程论坛的所有修改</description>

	<author-notes lang="cn">肖彤</author-notes>

	<author-group>
		<author>
			<username>xiaotong</username>
			<realname>肖彤</realname>
			<homepage>http://www.progbbs.com/</homepage>
			<email>xiaotong@progbbs.com</email>
		</author>
	</author-group>

	<mod-version>0.0.2</mod-version>

	<installation>
		<level>easy</level>
		<time>60</time>
		<target-version>3.0.12</target-version>
	</installation>
	<history>
		<entry>
			<date>2015-03-12</date>
			<rev-version>0.0.1</rev-version>
			<changelog lang="cn">
				<change>初始版本</change>
				<change>在首页/版面/帖子增加百度分享按钮，并可以通过配置开启/关闭</change>
			</changelog>
		</entry>
	</history>
</header>

<action-group>
	<copy>
		<file from="root/*.*" to="*.*" />
	</copy>
	<open src="index.php">
		<edit>
			<find>// Output page</find>
			<action type="before-add">// Begin: MOD ProgBBS
if ( $config['allow_baidu_share'] )
{
	$template->assign_vars(array(
		'S_BAIDU_SHARE' 			=> true,
	));
}
// End: MOD ProgBBS</action>
		</edit>
	</open>
	<open src="posting.php">
		<edit>
			<find>			// The last parameter tells submit_post if search indexer has to be run
			$redirect_url = submit_post($mode, $post_data['post_subject'], $post_author_name, $post_data['topic_type'], $poll, $data, $update_message, ($update_message || $update_subject) ? true : false);</find>
			<action type="before-add">			// Begin: MOD ProgBBS
			if( $config['noavatar_noapprove'] )
			{
				if( !$user->data['user_avatar'] )
					trigger_error('USER_NOAVATAR_DENIED');
			}
			// End: MOD ProgBBS
</action>
		</edit>
	</open>
	<open src="styles/prosilver/template/overall_header.html">
		<edit>
			<find><![CDATA[				<!-- IF U_PRINT_PM --><li class="rightside"><a href="{U_PRINT_PM}" title="{L_PRINT_PM}" accesskey="p" class="print">{L_PRINT_PM}</a></li><!-- ENDIF -->]]></find>
			<action type="after-add"><![CDATA[    <!-- IF S_BAIDU_SHARE --><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdPic":"","bdStyle":"0","bdSize":"16"},"share":{},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"....","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script><!-- ENDIF -->]]></action>
		</edit>
	</open>
	<open src="includes/acp/acp_board.php">
		<edit>
			<find>						'allow_quick_reply'		=> array('lang' => 'ALLOW_QUICK_REPLY',		'validate' => 'bool',	'type' => 'custom', 'method' => 'quick_reply', 'explain' => true),</find>
			<action type="after-add">						// Begin: MOD ProgBBS
						'noavatar_noapprove'	=> array('lang' => 'NOAVATAR_NOAPPROVE',	'validate' => 'bool',	'type' => 'radio:yes_no', 'explain' => true),
						// End: MOD ProgBBS</action>
		</edit>
	</open>
	<open src="includes/acp/acp_board.php">
		<edit>
			<find>						'allow_quick_reply'		=> array('lang' => 'ALLOW_QUICK_REPLY',		'validate' => 'bool',	'type' => 'custom', 'method' => 'quick_reply', 'explain' => true),</find>
			<action type="after-add">						// Begin: MOD ProgBBS
						'allow_baidu_share'	=> array('lang' => 'ALLOW_BAIDU_SHARE',	'validate' => 'bool',	'type' => 'radio:yes_no', 'explain' => true),
						// End: MOD ProgBBS</action>
		</edit>
	</open>
	<open src="language/zh_cmn_hans/posting.php">
		<edit>
			<find>	'VIEW_MESSAGE'				=> </find>
			<action type="before-add">	// Begin: MOD ProgBBS
	'USER_NOAVATAR_DENIED'	=> '为防止垃圾帖，请设置您的头像再发帖，我们会对您的帖进行审阅。'
	// End: MOD ProgBBS
</action>
		</edit>
	</open>
</action-group>
</mod>
